<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Fisheye Lens (Hyperbolic Lens) Vertex Shader in GLSL « pixel sorcery</title>
<link rel="stylesheet" href="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/style.css" type="text/css" media="screen">

<!--[if lt IE 7]>
<link rel="stylesheet" href="http://s2.wp.com/wp-content/themes/pub/monochrome/ie6.css?m=1302986173g" type="text/css" media="screen" />
<![endif]--> 
<link rel="pingback" href="http://pixelsorcery.wordpress.com/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="pixel sorcery » Feed" href="http://pixelsorcery.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="pixel sorcery » Comments Feed" href="http://pixelsorcery.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="pixel sorcery » Fisheye Lens (Hyperbolic Lens) Vertex Shader in&nbsp;GLSL Comments Feed" href="http://pixelsorcery.wordpress.com/2010/07/13/fisheye-vertex-shader/feed/">
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel="stylesheet" href="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/global.css" type="text/css">
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/l10n.js"></script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/jquery.js"></script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/jquery_002.js"></script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/jscript.js"></script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/comment.js"></script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/comment-reply.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://pixelsorcery.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://pixelsorcery.wordpress.com/wp-includes/wlwmanifest.xml"> 
<link rel="index" title="pixel sorcery" href="http://pixelsorcery.wordpress.com/">
<link rel="prev" title="welcome" href="http://pixelsorcery.wordpress.com/2010/04/02/hello-world/">
<link rel="next" title="Writing Mental Ray Shaders from Scratch for&nbsp;Maya" href="http://pixelsorcery.wordpress.com/2010/08/25/writing-mental-ray-shaders-from-scratch-for-maya/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="http://pixelsorcery.wordpress.com/2010/07/13/fisheye-vertex-shader/">
<link rel="shortlink" href="http://wp.me/pSfEy-4">
<link rel="shortcut icon" type="image/x-icon" href="http://s1.wp.com/i/favicon-stacked.ico?m=1302986152g" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="http://s1.wp.com/i/favicon-stacked.ico?m=1302986152g" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon" href="http://s0.wp.com/wp-content/themes/h4/i/webclip.png?m=1302986159g">
	<style type="text/css">
	/* <![CDATA[ */
				div#likes { margin-top: 15px; }
		.like-button { border: 1px solid #eee; padding: 2px 6px; font-size: 13px; font-family: arial, tahoma, sans-serif; }
		#wpl-likebox { clear: left; font-size: 11px; font-family: arial, tahoma, verdana, sans-serif !important; min-height: 30px; margin: 10px 0 !important; padding: 5px 0 10px 0 !important; }
		#wpl-button { float: left; background: url( http://s0.wp.com/i/buttonbg.png ) top left repeat-x; margin-right: 7px; border: 1px solid #d4d4d4; -moz-border-radius: 3px; -webkit-border-radius: 3px; border-radius: 3px; }
		#wpl-button a { color: #666 !important; line-height: 130% !important; text-decoration: none !important; outline: none; float: left; padding: 3px 6px 2px 24px !important; font-size: 11px !important; background: url( http://s1.wp.com/i/likestar.png ) 6px 49.8% no-repeat; }
		#wpl-button.liked { background: #feffce; border: 1px solid #f3e389; }
		#wpl-button.liked a { color: #ba871b !important; }
		#wpl-likebox #wpl-count { min-height: 25px; line-height: 130% !important; float: left; padding-top: 4px; }
		#wpl-likebox #wpl-avatars { clear: left; max-height: 98px; overflow: hidden; margin-top: 15px; line-height: 130% !important; }
		#wpl-likebox #wpl-avatars img { border: none !important; }
		#wpl-likebox #wpl-mustlogin { line-height: 14px !important; font-size: 11px; clear: left; margin-top: 5px; background: #f0f0f0; padding: 10px; width: 65%; -moz-border-radius: 3px; -webkit-border-radius: 3px; border-radius: 3px; }
		#wpl-likebox #wpl-mustlogin a { color: #888; text-decoration: underline; }
		#wpl-likebox #wpl-mustlogin p { margin: 5px 0; padding: 0 }
		#wpl-likebox #wpl-mustlogin input.input { padding: 2px; background: #fff; font-size: 11px; font-family: inherit; border: 1px solid #ccc; -moz-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1) inset; -webkit-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1) inset; line-height: 12px; }
		#wpl-likebox #wpl-mustlogin input#wp-submit { border: 1px solid #ccc; font-size: 11px; background: #fafafa; repeat-x; -moz-border-radius: 3px; -webkit-border-radius: 3px; border-radius: 3px; padding: 2px 4px !important; line-height: 12px; }
		#wpl-likebox #wpl-mustlogin label { position: relative; cursor: text; }
		#wpl-likebox #wpl-mustlogin label span { position: absolute; top: 0px; left: 5px; padding: 0 !important; }
		#wpl-likebox #wpl-mustlogin label span { top /*\**/: -10px\9; }
	/* ]]> */
	</style>
	<link rel="openid.server" href="http://pixelsorcery.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="http://pixelsorcery.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="http://pixelsorcery.wordpress.com/osd.xml" title="pixel sorcery">
<link rel="search" type="application/opensearchdescription+xml" href="http://wordpress.com/opensearch.xml" title="WordPress.com">
	<script type="text/javascript" charset="utf-8">
		try{
			var id = location.hash.match( /\#\!\/entry\/(\d+)/ )[1];
			if ( id ) {
				window.location = "http://pixelsorcery.wordpress.com?p=" + id;
			};
		}catch( error ){
		}
	</script>		
<meta name="application-name" content="pixel sorcery"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="It's all about aesthetics."><meta name="msapplication-task" content="name=Subscribe;action-uri=http://pixelsorcery.wordpress.com/feed/;icon-uri=http://s1.wp.com/i/favicon-stacked.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico">
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/google_service.js">
</script>
<script type="text/javascript">
GS_googleAddAdSenseService("ca-pub-3443918307802676");
GS_googleEnableAllServices();
</script>
<script type="text/javascript">
GA_googleAddSlot("ca-pub-3443918307802676", "wpcom_below_post");
</script>
<script type="text/javascript">
GA_googleFetchAds();
</script><script type="text/javascript"> 
	window.google_analytics_uacct = "UA-52447-2"; 
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/ga.js" async="" type="text/javascript"></script>

<link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/services.css"></head>

<body class="single single-post postid-4 single-format-standard">
<div id="wrapper">

 <div id="header" class="clearfix">

  <div id="header_top"> 
   <div id="logo">
    <a href="http://pixelsorcery.wordpress.com/">pixel sorcery</a>
    <h1>It's all about aesthetics.</h1>
   </div>
   <div id="header_menu">
	<ul class="menu" id="menu">
     <li class="page_item first_menu"><a href="http://pixelsorcery.wordpress.com/">HOME</a></li>
     <li class="page_item page-item-2 last_menu"><a href="http://pixelsorcery.wordpress.com/about/" title="About">About</a></li>
</ul>
   </div>
  </div>

  </div><!-- #header end -->  <div id="contents" class="clearfix">

   <div id="left_col">


    <div class="post clearfix" id="single_post">
     <div class="post_content_wrapper">
      <h2><span>Fisheye Lens (Hyperbolic Lens) Vertex Shader in&nbsp;GLSL</span></h2>
      <div class="post_content">
       <p>Today I will write about my fisheye (hyperbolic) lens shader. 
It was part of a larger project to simulate a wide depth of field and 
imperfections in human eyesight. Anyway, I like the way it came out, so I
 will describe how I went about the process in GLSL. A fisheye lens 
allows an extremely wide field of view, nearly 180 degrees, but  it also
 bends the light in order to fit it all on a square so you get an 
interesting effect where the  edges become distorted and straight lines 
become curved. Since it’s just an approximation, and  it works on 
vertices,  the quality is limited to the amount of vertices on screen.  
Here are some pictures which describe how it works. (10,000 hours in ms 
paint)<br>
<span id="more-4"></span></p>
<p>First we project A which is the vector from the camera to the point 
we  are looking at, unto B, which is the lookat point. This is the point
 that is in the center of  the frustum, basically the Z axis in the 
current coordinate system. Then after projecting we get C. Then  we 
subtract and get the C-A vector. Then we find a halfway point of that 
and calculate D by subtracting  camera_pos – C-A/2.</p>
<p><img class="aligncenter" title="Fig a" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/fisheye_expln.jpg" alt="" height="480" width="640">Then
 we take the magnitude of A and multiply it by the direction of D  
effectively rotating point A and bringing it closer to the center of the
 camera.</p>
<p style="text-align:center;"><img class="aligncenter" title="Fig b" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/fisheye_expln3.png" alt="" height="480" width="640"></p>
<p style="text-align:left;">Here is a scene with a regular 45 degree field of view.</p>
<p style="text-align:center;"><img class="aligncenter" title="regular fov" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/regular_fov.png" alt="" height="480" width="640"></p>
<p style="text-align:left;">
</p><p style="text-align:left;">And now what we’ve all been waiting for. Per pixel phong shading + fisheye lens shader.</p>
<p style="text-align:center;"><img class="aligncenter" title="fisheye shader" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/fisheye_fov1.png" alt="" height="480" width="640"></p>
<p style="text-align:left;">
</p><p style="text-align:left;">The vertex shader:</p>
<p><span style="font-family:Arial;font-size:x-small;"> </span></p>
<pre> 1: varying vec4 normal<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> light_dir<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> eye_vec<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> lookat<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 2: <span style="color:red;"><strong>const</strong></span> <span style="color:red;"><strong>float</strong></span> PI <span style="color:blue;font-size:xx-small;">=</span>  <span style="color:yellow;">3.14159265</span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 3:
 4: <span style="color:red;"><strong>void</strong></span> main<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span>
 5: <span style="color:blue;font-size:xx-small;"><strong>{</strong></span>
 6: 	vec4 ambient<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> diffuse<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> specular<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 7: 	<span style="color:red;"><strong>float</strong></span> NdotL<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> RdotV<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 8:
 9: 	normal <span style="color:blue;font-size:xx-small;">=</span> vec4<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>gl_NormalMatrix <span style="color:blue;font-size:xx-small;">*</span> gl_Normal<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> <span style="color:yellow;">0.0</span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
10: 	vec4 vVertex <span style="color:blue;font-size:xx-small;">=</span> gl_ModelViewMatrix <span style="color:blue;font-size:xx-small;">*</span> gl_Vertex<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
11: 	light_dir <span style="color:blue;font-size:xx-small;">=</span> gl_LightSource<span style="color:blue;font-size:xx-small;"><strong>[</strong></span><span style="color:brown;">0</span><span style="color:blue;font-size:xx-small;"><strong>]</strong></span><span style="color:blue;font-size:xx-small;"><strong>.</strong></span>position <span style="color:blue;font-size:xx-small;">-</span> vVertex<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
12: 	eye_vec <span style="color:blue;font-size:xx-small;">=</span> <span style="color:blue;font-size:xx-small;">-</span>vVertex<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
13:
14: 	vec4 temp_pos <span style="color:blue;font-size:xx-small;">=</span> ftransform<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
15:
16: 	<span style="color:red;"><strong>float</strong></span> dist <span style="color:blue;font-size:xx-small;">=</span> length<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>eye_vec<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
17: 	lookat <span style="color:blue;font-size:xx-small;">=</span> eye_vec <span style="color:blue;font-size:xx-small;">-</span> temp_pos<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
18: 	vec4 dir <span style="color:blue;font-size:xx-small;">=</span> temp_pos <span style="color:blue;font-size:xx-small;">-</span> eye_vec<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
19: 	vec4 center <span style="color:blue;font-size:xx-small;">=</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;">-</span>eye_vec<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
20: 	vec4 proj <span style="color:blue;font-size:xx-small;">=</span> dot<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>temp_pos<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;">-</span>lookat<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span> <span style="color:blue;font-size:xx-small;">*</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;">-</span>lookat<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
21:
22: 	vec4 c <span style="color:blue;font-size:xx-small;">=</span> temp_pos <span style="color:blue;font-size:xx-small;">-</span> proj<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
23:
24: 	<span style="color:red;"><strong>float</strong></span> magnitude <span style="color:blue;font-size:xx-small;">=</span> .01<span style="color:blue;font-size:xx-small;"><strong>;</strong></span><span style="color:green;"><em>//1-acos(dot(normalize(-eye_vec), normalize(temp_pos)));
25: </em></span>
26: 	c <span style="color:blue;font-size:xx-small;">=</span> length<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>c<span style="color:blue;font-size:xx-small;"><strong>)</strong></span> <span style="color:blue;font-size:xx-small;">*</span> magnitude <span style="color:blue;font-size:xx-small;">*</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>c<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
27:
28: 	vec4 dir2 <span style="color:blue;font-size:xx-small;">=</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>c<span style="color:blue;font-size:xx-small;">-</span>lookat<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
29:
30: 	dir2 <span style="color:blue;font-size:xx-small;">=</span> <span style="color:blue;font-size:xx-small;"><strong>(</strong></span>dir2 <span style="color:blue;font-size:xx-small;">*</span> dist<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
31:
32: 	gl_Position<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>xyz <span style="color:blue;font-size:xx-small;">=</span> dir2.xyz<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
33: 	gl_Position<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>w <span style="color:blue;font-size:xx-small;">=</span> ftransform<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>.</strong></span>w<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
34:
35: <span style="color:blue;font-size:xx-small;"><strong>}</strong></span>
</pre>
<p>The pixel shader:</p>
<p><span style="font-family:Arial;font-size:x-small;"></span></p>
<pre> 1: varying vec4 normal<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> light_dir<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> eye_vec<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 2:
 3: uniform vec4 camera_pos<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 4:
 5: <span style="color:red;"><strong>void</strong></span> main<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span>
 6: <span style="color:blue;font-size:xx-small;"><strong>{</strong></span>
 7:
 8: 	vec4 ambient<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> diffuse<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> specular<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
 9: 	<span style="color:red;"><strong>float</strong></span> NdotL<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> RdotV<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
10:
11: 	vec4 N <span style="color:blue;font-size:xx-small;">=</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>normal<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
12: 	vec4 L <span style="color:blue;font-size:xx-small;">=</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>light_dir<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
13: 	NdotL <span style="color:blue;font-size:xx-small;">=</span> dot<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>N<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> L<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
14: 	<span style="color:green;"><em>//RdotV = max(dot(R, V), 0.0);
15: </em></span>	gl_FragColor <span style="color:blue;font-size:xx-small;">=</span> gl_FrontMaterial<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>ambient <span style="color:blue;font-size:xx-small;">*</span> gl_LightSource<span style="color:blue;font-size:xx-small;"><strong>[</strong></span><span style="color:brown;">0</span><span style="color:blue;font-size:xx-small;"><strong>]</strong></span><span style="color:blue;font-size:xx-small;"><strong>.</strong></span>ambient<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
16:
17: 	<span style="color:red;"><strong>if</strong></span><span style="color:blue;font-size:xx-small;"><strong>(</strong></span>NdotL <span style="color:blue;font-size:xx-small;">&gt;</span> <span style="color:yellow;">0.0</span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span>
18: 	<span style="color:blue;font-size:xx-small;"><strong>{</strong></span>
19: 		ambient <span style="color:blue;font-size:xx-small;">=</span> gl_FrontMaterial<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>ambient <span style="color:blue;font-size:xx-small;">*</span> gl_LightSource<span style="color:blue;font-size:xx-small;"><strong>[</strong></span><span style="color:brown;">0</span><span style="color:blue;font-size:xx-small;"><strong>]</strong></span><span style="color:blue;font-size:xx-small;"><strong>.</strong></span>ambient<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
20: 		diffuse <span style="color:blue;font-size:xx-small;">=</span> gl_FrontMaterial<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>diffuse <span style="color:blue;font-size:xx-small;">*</span> gl_LightSource<span style="color:blue;font-size:xx-small;"><strong>[</strong></span><span style="color:brown;">0</span><span style="color:blue;font-size:xx-small;"><strong>]</strong></span><span style="color:blue;font-size:xx-small;"><strong>.</strong></span>diffuse<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
21: 		specular <span style="color:blue;font-size:xx-small;">=</span> gl_FrontMaterial<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>specular <span style="color:blue;font-size:xx-small;">*</span> gl_LightSource<span style="color:blue;font-size:xx-small;"><strong>[</strong></span><span style="color:brown;">0</span><span style="color:blue;font-size:xx-small;"><strong>]</strong></span><span style="color:blue;font-size:xx-small;"><strong>.</strong></span>specular<span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
22: 		vec4 E <span style="color:blue;font-size:xx-small;">=</span> normalize<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>eye_vec<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
23: 		vec4 R <span style="color:blue;font-size:xx-small;">=</span> reflect<span style="color:blue;font-size:xx-small;"><strong>(</strong></span><span style="color:blue;font-size:xx-small;">-</span>L<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> N<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
24:
25: 		gl_FragColor <span style="color:blue;font-size:xx-small;">+</span><span style="color:blue;font-size:xx-small;">=</span>  <span style="color:blue;font-size:xx-small;"><strong>(</strong></span>NdotL <span style="color:blue;font-size:xx-small;">*</span> diffuse<span style="color:blue;font-size:xx-small;"><strong>)</strong></span> <span style="color:blue;font-size:xx-small;">+</span>
26: 				specular <span style="color:blue;font-size:xx-small;">*</span> pow<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>max<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>dot<span style="color:blue;font-size:xx-small;"><strong>(</strong></span>R<span style="color:blue;font-size:xx-small;"><strong>,</strong></span> E<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>,</strong></span> <span style="color:yellow;">0.0</span><span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>,</strong></span> gl_FrontMaterial<span style="color:blue;font-size:xx-small;"><strong>.</strong></span>shininess<span style="color:blue;font-size:xx-small;"><strong>)</strong></span><span style="color:blue;font-size:xx-small;"><strong>;</strong></span>
27: 	<span style="color:blue;font-size:xx-small;"><strong>}</strong></span>
28: <span style="color:blue;font-size:xx-small;"><strong>}</strong></span></pre>

<!-- wpcom_below_post -->
<div style="margin-bottom: 10px;" align="center">
<script type="text/javascript">
GA_googleAddAttr("AdOpt", "1");
GA_googleAddAttr("Origin", "extsearch");
GA_googleAddAttr("SearchTerm", "fish"); GA_googleAddAttr("SearchTerm", "eye"); GA_googleAddAttr("SearchTerm", "shader"); GA_googleAddAttr("LangId", "1");
GA_googleAddAttr("Autotag", "technology"); GA_googleAddAttr("Autotag", "entertainment"); GA_googleAddAttr("Tag", "glsl"); GA_googleAddAttr("Tag", "opengl"); GA_googleAddAttr("Tag", "shaders"); 
GA_googleFillSlot("wpcom_below_post");
</script>
</div>              </div>
     </div>
     <dl class="post_meta">
        <dt class="meta_date">2010</dt>
         <dd class="post_date">07<span>/13</span></dd>
               <dt>CATEGORY</dt>
        <dd><a href="http://en.wordpress.com/tag/glsl/" title="View all posts in GLSL" rel="category tag">GLSL</a><br><a href="http://en.wordpress.com/tag/opengl/" title="View all posts in OpenGL" rel="category tag">OpenGL</a><br><a href="http://en.wordpress.com/tag/shaders/" title="View all posts in Shaders" rel="category tag">Shaders</a></dd>
                                <dt class="meta_comment"><a href="#respond">Write comment</a></dt>
             </dl>
    </div>


<div id="comments_wrapper">
<div id="wpl-likebox"><div id="wpl-button"><a href="http://pixelsorcery.wordpress.com/2010/07/13/fisheye-vertex-shader/?like=1&amp;_wpnonce=0eda2fd316" title="I like this post" class="like needs-login" rel="nofollow"><span>Like</span></a></div><div id="wpl-count">Be the first to like this post.</div></div><div id="comments">





 <div id="comment_header" class="clearfix">

  <ul id="comment_header_left">
   <li id="add_comment"><a href="#respond">Write comment</a></li>
   <li id="comment_feed"><a href="http://pixelsorcery.wordpress.com/comments/feed/" title="Comments RSS">Comments RSS</a></li>
  </ul>

  <ul id="comment_header_right">
    <li id="trackback_switch"><a href="javascript:void(0);">Trackback ( 1 )</a></li>
    <li id="comment_switch" class="comment_switch_active"><a href="javascript:void(0);">Comments ( 0 )</a></li>
  </ul>


 </div><!-- comment_header END -->


<div id="comment_area">
<!-- start commnet -->
<ol class="commentlist">
	</ol>
<!-- comments END -->


</div><!-- #comment-list END -->


<div id="trackback_area">
<!-- start trackback -->

<div id="trackback_url_wrapper">
<label for="trackback_url">TrackBack URL</label>
<input name="trackback_url" id="trackback_url" size="60" value="http://pixelsorcery.wordpress.com/2010/07/13/fisheye-vertex-shader/trackback/" readonly="readonly" onfocus="this.select()" type="text">
</div>

<ol class="commentlist">


<li class="comment">
 <div class="trackback_time">
  August 22nd, 2010   </div>
 <div class="trackback_title">
  Trackback from : <a href="http://codeanticode.wordpress.com/2010/08/22/glgraphics-0-9-4/">GLGraphics 0.9.4 « codeanticode</a>
 </div>
</li>

</ol>
<!-- trackback end -->
</div><!-- #trackbacklist END -->






								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://pixelsorcery.wordpress.com/2010/07/13/fisheye-vertex-shader/#respond" style="display: none;">Cancel reply</a></small></h3>
									<form action="http://pixelsorcery.wordpress.com/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" size="30" aria-required="true" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" size="30" type="text"></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a
 href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; 
&lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; 
&lt;pre&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q 
cite=""&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" id="submit" value="Post Comment" type="submit">
							<input name="comment_post_ID" value="4" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
						</p>
						
<input name="genseq" value="1305020309" type="hidden">
<p class="comment-subscription-form"><input name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe">Notify me of follow-up comments via email.</label></p><p class="comment-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;" tabindex="7" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Subscribe by email to this site</label></p><input name="sub-type" value="comment-form-text1" type="hidden"><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="7f90efcb6c" type="hidden"></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comment end --></div>

   </div><!-- #left_col end -->

   <div id="right_col">
  
    <div id="information_area" class="clearfix">
   <div class="side_box first_side_box" id="information">
    <h3>pixel sorcery</h3>
    <div id="information_contents"><p>
pixel - the smallest discrete component of an image or picture on a computer screen </p>
<p>
sorcery - the belief in magical spells that harness occult forces or evil spirits to produce unnatural effects in the world
</p></div>
   </div>
      <div id="entries_rss">
    <a href="http://pixelsorcery.wordpress.com/feed/" title="Entries RSS">RSS FEED</a>
   </div>
     </div>
  
    <div class="side_box" id="search_area_top">
   <div id="search_area" class="clearfix">
    <form method="get" id="searchform" action="http://pixelsorcery.wordpress.com/">
     <div><input value="Search" name="s" id="search_input" onfocus="this.value=''; changefc('white');" type="text"></div>
     <div><input src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/search_button_n.gif" alt="Search from this blog." title="Search from this blog." id="search_button" type="image"></div>
    </form>
   </div>
     </div>
  
  <div class="side_box" id="linkcat-1356">
<h3>Blogroll</h3>

	<ul class="xoxo blogroll">
<li><a href="http://codeanticode.wordpress.com/2010/08/22/glgraphics-0-9-4/" target="_blank">codeanticode</a></li>
<li><a href="http://halogenica.net/" title="Mike Romero’s Graphics Blog">Halogenica</a></li>
<li style="margin-bottom: 0pt;"><a href="http://pixplosion.blogspot.com/">PiXplosion</a></li>

	</ul>
</div>


  
</div><!-- #right_col end -->
  </div><!-- #contents end -->

  <div id="footer">
	<div id="site-info"><a href="http://wordpress.com/?ref=footer" rel="generator">Blog at WordPress.com</a>. | Theme: <a href="http://theme.wordpress.com/themes/monochrome/">monochrome</a> by <a href="http://www.mono-lab.net/" rel="designer">mono-lab</a>.</div>
	</div>

</div><!-- #wrapper end -->

<div id="return_top">
 <a href="#wrapper"></a>
</div>

<script type="text/javascript">
	/* <![CDATA[ */
	var menu=new menu.dd("menu");
	menu.init("menu","menuhover");
	/* ]]> */
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	/* <![CDATA[ */
		jQuery( function() {
			
			jQuery('#wpl-button > a.like').click( function(e) {
				e.preventDefault();
				
				jQuery('#wpl-mustlogin').remove();

				jQuery.post( 'http://pixelsorcery.wordpress.com/wp-admin/admin-ajax.php', { 
					'action': 'wpl_record_stat',
					'stat_name': 'loggedout_like_click'
				} );

				var tenMins = new Date();
				tenMins.setTime( tenMins.getTime() + 600000 );
				document.cookie = 'wpl_rand=bd63b72c3a; expires=' + tenMins.toGMTString() + '; domain=wordpress.com; path=/;';
				
				jQuery('#wpl-count').after( '\
					<div id="wpl-mustlogin"> \
						<form action="http://pixelsorcery.wordpress.com/wp-login.php" method="post"> \
							<p>Just one more step to like this post:</p> \
							<label><span>Username</span> <input type="text" name="log" id="user_login" class="input" value="" size="20" tabindex="80" /></label> \
							<label><span>Password</span> <input type="password" name="pwd" id="user_pass" class="input" value="" size="20" tabindex="81" /></label> \
							<input type="submit" name="wp-submit" id="wp-submit" class="button-primary" value="Log In" tabindex="82" /> \
							<input type="hidden" name="redirect_to" value="http://pixelsorcery.wordpress.com/2010/07/13/fisheye-vertex-shader/?like=1" /> \
							<input type="hidden" name="wpl_rand" value="bd63b72c3a" /> \
							<p>Not a member yet? <a href="http://wordpress.com/signup/?ref=likebox" id="wpl-signup-link">Sign up with WordPress.com</a></p> \
						</form> \
					</div> \
				');
				
				jQuery('#wpl-mustlogin').hide().slideDown('fast');
			} );
			
			jQuery('#wpl-mustlogin input.input').live( 'focus', function() {
				jQuery(this).prev().hide();
			}).live( 'blur', function() {
				if ( jQuery(this).val() == '' )
					jQuery(this).prev().show();
			});
			
			jQuery('#wpl-mustlogin input#wp-submit').live( 'click', function(e) {
				e.preventDefault();
				
				jQuery.post( 'http://pixelsorcery.wordpress.com/wp-admin/admin-ajax.php', { 
					'action': 'wpl_record_stat',
					'stat_name': 'loggedout_login_submit'
				}, function() {
					jQuery('#wpl-mustlogin form').submit();
				} );
			});			
			
			jQuery('#wpl-mustlogin a#wpl-signup-link').live( 'click', function(e) {
				e.preventDefault();
				
				var link = jQuery(this).attr('href');
				
				jQuery.post( 'http://pixelsorcery.wordpress.com/wp-admin/admin-ajax.php', { 
					'action': 'wpl_record_stat',
					'stat_name': 'loggedout_signup_click'
				}, function() {
					location.href = link;
				} );
			});					
			
		});
	/* ]]> */
	</script>
<script type="text/javascript">_qoptions={qacct:'p-18-mFEk4J448M',labels:'language.en,type.wpcom'};</script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/quant.js"></script>
<noscript><p><img class="robots-nocontent" src="http://pixel.quantserve.com/pixel/p-18-mFEk4J448M.gif?labels=language.en%2Ctype.wpcom" style="display:none" height="1" width="1" alt="" /></p></noscript>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {
	my_hash: ""
};
/* ]]> */
</script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/wpgroho.js"></script>
	<div style="display:none">
	</div>
<script type="text/javascript">_acseed='JlZZSUUlYjhfbWgjTzhUM05PZXc+Smw0TjhRKFVxeVBwWzUmbm1ESUNvYyAhczg8L2dAe29pRC82bEVRWV1NSFVXd0RwbyAtNHB2IHh2L3NlX1FvbiVEP1Z2a2xMeis+U0NlPjZlMDxzczVrLUpZbm1SXkl8L3RRYmpAV2R7XjNFYG4kTDp3WGhMNlAxQVQgYg==';</script>
<script type="text/javascript" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/beacon.js"></script><script type="text/javascript">try{COMSCORE.beacon({c1:2,c2:7518284});}catch(e){}</script><noscript><p class="robots-nocontent"><img src="http://b.scorecardresearch.com/p?cj=1c1=2&#038;c2=7518284" alt="" style="display:none" width="1" height="1" /></p></noscript><script src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/w.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({'blog':'12929886','v':'wpcom','user_id':'0','post':'4','subd':'pixelsorcery'});
ex_go({'crypt':'UE5XaFBLcG9HLE5XPUhlbC8mTGtZYStmOGpLcV96UkpLeFE4clc/N1tpbUtoeUdVZnFIVHEzaFE9SnNGUzM1SFZLNGg/bS5qVjUsR2ZJfDIsTl83QUxKJXpHRVZ1UHBkLEFaZFdpWWZDP3ljQlVsTW8xV2sxdi9VWHJQKzd2cn42LWkzY1VHRWhScD15SXJlJlVNP09yVkJxUHdrZDZaVDNUcmhwbFNdN100bGFBYj9xMC5PWUFFN3FGS1Q5eDlNWE8lUVJsL0xpUzc1Mk9HOXd2fHQmRS91M2RiJklKZiY/RVZtTV8laGtpZF9BXSYtcHZKUm9CbGJqU1h8SGZkUFFfckpLQ3ZbP1NdUjQ9VTYmLSZTZkRsbjRkQWFJWi9VU35Bb21WN2U1K3RtdEUrNTFKdGwsQ1pMYUVJV3lTWDQyY3NELE9wRTlQekc/TEU5TnpdflMlQVkseFU2KywxR1FjcDltUG8vVj1QK3Y9VTlnflJzM1JEMXRbMHB4bWJoWkhIS3ZlNzJSMmhTdUNCYkp0XXZRLQ=='});
addLoadEvent(function(){linktracker_init('12929886',4);});
	</script><img id="wpstats" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/g.gif" alt=""><img id="wpstats2" src="Fisheye%20Lens%20%28Hyperbolic%20Lens%29%20Vertex%20Shader%20in%20GLSL%20%C2%AB%20pixel%20sorcery-Dateien/g_002.gif" alt="" style="display: none;">

</body></html>